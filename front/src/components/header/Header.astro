---
import { Image } from 'astro:assets';
import logo from '../../assets/img/logo.png';
import { getAbsoluteLocaleUrl, getRelativeLocaleUrl } from 'astro:i18n';
import { useTranslations } from '@/i18n/utils';
import { languagesList } from '@/i18n/ui';

const currentLang = Astro.currentLocale || 'es';

const t = useTranslations(currentLang as keyof typeof languagesList);
---

<header class="header">
	<div>
		<div id="overlay"></div>
		<div class="logo header__logo">
			<a
				href={getRelativeLocaleUrl(currentLang, '/')}
				aria-label="Ir al inicio de la web"
			>
				<Image src={logo} width={473} height={267} alt={'logo'} />
			</a>
		</div>
		<div>
			<button id="toggle" class="toggle" aria-label="boton de menu">
				<svg
					width="24"
					height="24"
					fill="none"
					xmlns="http://www.w3.org/2000/svg"
				>
					<g clip-path="url(#a)">
						<path d="M51 18H3v-2h48v2Zm0-5H3v-2h48v2Zm0-5H3V6h48v2Z" fill="#000"
						></path>
					</g>
					<defs>
						<clipPath id="a">
							<path fill="#fff" d="M0 0h24v24H0z"></path>
						</clipPath>
					</defs>
				</svg>
			</button>
		</div>
		<nav
			id="site-navigation"
			class="site-navigation"
			aria-label="Clickable Menu Demonstration"
		>
			<button
				id="closeNavMenu"
				class="closeBtn"
				aria-label="Hide Navigation Menu"
			>
				<svg
					width="24"
					height="24"
					fill="none"
					xmlns="http://www.w3.org/2000/svg"
				>
					<path
						d="M17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41 17.59 5Z"
						fill="#ebc3bc"></path>
				</svg>
			</button>
			<div>
				<ul class="main-menu clicky-menu no-js">
					<li>
						<a
							href={getRelativeLocaleUrl(currentLang, '/')}
							data-astro-prefetch="hover">{t('menu.item.inicio')}</a
						>
					</li>
					<li>
						<a
							href={getAbsoluteLocaleUrl(currentLang, 'about')}
							data-astro-prefetch="hover">{t('menu.item.sobre-mi')}</a
						>
					</li>
					<li>
						<a
							href={getAbsoluteLocaleUrl(currentLang, 'services')}
							data-astro-prefetch="hover">{t('menu.item.servicios')}</a
						>
					</li>
					<li>
						<a
							href={getAbsoluteLocaleUrl(currentLang, 'contact')}
							data-astro-prefetch="hover">{t('menu.item.contacto')}</a
						>
					</li>
					<li class="nav-trasnlate-link-es">
						<a
							class="text-secondary px-1"
							href={getRelativeLocaleUrl('es', '/')}>ES</a
						>
					</li>
					<li class="nav-trasnlate-link-eu">
						<a
							class="text-secondary px-2"
							href={getRelativeLocaleUrl('eu', '/')}>EU</a
						>
					</li>
				</ul>
			</div>
		</nav>
	</div>
</header>
<script type="module" src="/js/header.js"></script>
<!-- <script is:inline>
	(function () {
		'use strict';

		const ClickyMenus = function (menu) {
			let container = menu.parentElement,
				currentMenuItem,
				i,
				len;

			this.init = function () {
				menuSetup();
				document.addEventListener('click', closeOpenMenu);
			};

			function toggleOnMenuClick(e) {
				const button = e.currentTarget;

				if (currentMenuItem && button !== currentMenuItem) {
					toggleSubmenu(currentMenuItem);
				}

				toggleSubmenu(button);
			}

			function toggleSubmenu(button) {
				const submenu = document.getElementById(
					button.getAttribute('aria-controls'),
				);

				if ('true' === button.getAttribute('aria-expanded')) {
					button.setAttribute('aria-expanded', false);
					submenu.setAttribute('aria-hidden', true);
					currentMenuItem = false;
				} else {
					button.setAttribute('aria-expanded', true);
					submenu.setAttribute('aria-hidden', false);
					preventOffScreenSubmenu(submenu);
					currentMenuItem = button;
				}
			}

			function preventOffScreenSubmenu(submenu) {
				const screenWidth =
						window.innerWidth ||
						document.documentElement.clientWidth ||
						document.body.clientWidth,
					parent = submenu.offsetParent,
					menuLeftEdge = parent.getBoundingClientRect().left,
					menuRightEdge = menuLeftEdge + submenu.offsetWidth;

				if (menuRightEdge + 32 > screenWidth) {
					submenu.classList.add('sub-menu--right');
				}
			}

			function closeOnEscKey(e) {
				if (27 === e.keyCode) {
					if (null !== e.target.closest('ul[aria-hidden="false"]')) {
						currentMenuItem.focus();
						toggleSubmenu(currentMenuItem);
					} else if ('true' === e.target.getAttribute('aria-expanded')) {
						toggleSubmenu(currentMenuItem);
					}
				}
			}

			function closeOpenMenu(e) {
				if (currentMenuItem && !e.target.closest('#' + container.id)) {
					toggleSubmenu(currentMenuItem);
				}
			}

			function menuSetup() {
				menu.classList.remove('no-js');

				menu.querySelectorAll('ul').forEach((submenu) => {
					const menuItem = submenu.parentElement;

					if ('undefined' !== typeof submenu) {
						let button = convertLinkToButton(menuItem);

						setUpAria(submenu, button);

						button.addEventListener('click', toggleOnMenuClick);
						menu.addEventListener('keyup', closeOnEscKey);
					}
				});
			}

			function convertLinkToButton(menuItem) {
				const link = menuItem.getElementsByTagName('a')[0],
					linkHTML = link.innerHTML,
					linkAtts = link.attributes,
					button = document.createElement('button');

				if (null !== link) {
					button.innerHTML = linkHTML.trim();
					for (i = 0, len = linkAtts.length; i < len; i++) {
						let attr = linkAtts[i];
						if ('href' !== attr.name) {
							button.setAttribute(attr.name, attr.value);
						}
					}

					menuItem.replaceChild(button, link);
				}

				return button;
			}

			function setUpAria(submenu, button) {
				const submenuId = submenu.getAttribute('id');

				let id;
				if (null === submenuId) {
					id =
						button.textContent.trim().replace(/\s+/g, '-').toLowerCase() +
						'-submenu';
				} else {
					id = menuItemId + '-submenu';
				}

				button.setAttribute('aria-controls', id);
				button.setAttribute('aria-expanded', false);

				submenu.setAttribute('id', id);
				submenu.setAttribute('aria-hidden', true);
			}
		};

		document.addEventListener('DOMContentLoaded', function () {
			const menus = document.querySelectorAll('.clicky-menu');

			menus.forEach((menu) => {
				let clickyMenu = new ClickyMenus(menu);
				clickyMenu.init();
			});
		});
	})();
	var toggle = document.querySelector('#toggle');
	var menu = document.querySelector('#site-navigation');
	var overlay = document.getElementById('overlay');
	var closeNavMenu = document.getElementById('closeNavMenu');

	toggle.addEventListener('click', function (e) {
		e.stopImmediatePropagation();
		if (menu.classList.contains('is-active')) {
			menu.classList.remove('is-active');
		} else {
			overlay.classList.add('overlay');
			menu.classList.add('is-active');
			toggle.classList.add('u-hidden');
		}
	});
	overlay.addEventListener('click', function () {
		if (menu.classList.contains('is-active')) {
			overlay.classList.remove('overlay');
			menu.classList.remove('is-active');
			toggle.classList.remove('u-hidden');
		} else {
			overlay.classList.add('overlay');
			menu.classList.add('is-active');
		}
	});
	closeNavMenu.addEventListener('click', function () {
		if (menu.classList.contains('is-active')) {
			overlay.classList.remove('overlay');
			menu.classList.remove('is-active');
			toggle.classList.remove('u-hidden');
		} else {
			overlay.classList.add('overlay');
			menu.classList.add('is-active');
		}
	});
</script> -->
