---
import { useTranslations } from '@/i18n/utils';
import type { languagesList } from '@/i18n/ui';
import CldImage from '@/components/image/Image.astro';

const currentLang = Astro.currentLocale || 'es';
const t = useTranslations(currentLang as keyof typeof languagesList);
const services = Astro.props;
---

<section class="h-services boxes-services">
	<p class="heading-title" tabindex="0">{t('heading.title.servicios')}</p>
	<ul class="boxes-services__list">
		<li class="boxes-services__item animated-2">
			<a href={`/${currentLang}/services/#service-01`} class="h-services__link">
				<CldImage
					src={services.service[0].image.unpicUrl}
					height={530}
					width={640}
					alt=""
					class="h-services__img"
				/>
				<span class="h-services__text">{t('list.item.service01')}</span>
			</a>
		</li>
		<li class="boxes-services__item animated-2">
			<a href={`/${currentLang}/services/#service-02`} class="h-services__link">
				<CldImage
					src={services.service[1].image.unpicUrl}
					height={530}
					width={640}
					class="h-services__img"
					alt=""
					layout="constrained"
					priority={false}
					cdn="cloudinary"
				/>
				<span class="h-services__text">{t('list.item.service03')}â€‹</span>
			</a>
		</li>
		<li class="boxes-services__item animated-2">
			<a href={`/${currentLang}/services/#service-01`} class="h-services__link">
				<CldImage
					src={services.service[2].image.unpicUrl}
					height={530}
					width={640}
					class="h-services__img"
					alt=""
					layout="constrained"
					priority={false}
					cdn="cloudinary"
				/>
				<span class="h-services__text">{t('list.item.service04')}</span>
			</a>
		</li>
		<li class="boxes-services__item animated-2">
			<a href={`/${currentLang}/services/#service-04`} class="h-services__link">
				<CldImage
					src={services.service[3].image.unpicUrl}
					height={530}
					width={640}
					class="h-services__img"
					alt=""
					layout="constrained"
					priority={false}
					cdn="cloudinary"
				/>
				<span class="h-services__text">{t('list.item.service05')}</span>
			</a>
		</li>
		<li class="boxes-services__item animated-2">
			<a href={`/${currentLang}/services/#service-01`} class="h-services__link">
				<CldImage
					src={services.service[4].image.unpicUrl}
					height={530}
					width={640}
					class="h-services__img"
					alt=""
					layout="constrained"
					priority={false}
					cdn="cloudinary"
				/>
				<span class="h-services__text">{t('list.item.service05')}</span>
			</a>
		</li>
	</ul>
</section>
<script>
	document.addEventListener('DOMContentLoaded', () => {
		const options = { threshold: 0.1 };
		const animatedElements = document.querySelectorAll('.animated-2');

		const observer = new IntersectionObserver((entries, observer) => {
			const visibleEntries = entries.filter((entry) => {
				if (!(entry.target instanceof HTMLElement)) return false;
				return (
					entry.isIntersecting &&
					!entry.target.classList.contains('animated--done')
				);
			});

			visibleEntries.forEach((entry, index) => {
				if (entry.target instanceof HTMLElement) {
					entry.target.style.animationDelay = `${index * 150}ms`;
					entry.target.classList.add('slide-in-right', 'animated--done');
					observer.unobserve(entry.target);
				}
			});
		}, options);

		animatedElements.forEach((el) => observer.observe(el));
	});
</script>
<style>
	.boxes-services {
		width: 92%;
		max-width: 120rem;
		margin-left: auto;
		margin-right: auto;
	}

	.boxes-services__list {
		margin-top: 6rem;
	}

	@media screen and (min-width: 47.82rem) {
		.boxes-services__list {
			display: grid;
			grid-row-gap: 1rem;
			grid-column-gap: 3rem;
		}
		.boxes-services__list > *:nth-child(1) {
			grid-row: 1;
			grid-column: 1;
		}
		.boxes-services__list > *:nth-child(2) {
			grid-row: 1;
			grid-column: 3;
		}
		.boxes-services__list > *:nth-child(3) {
			grid-row: 3;
			grid-column: 1;
		}
		.boxes-services__list > *:nth-child(4) {
			grid-row: 3;
			grid-column: 3;
		}
		.boxes-services__list > *:nth-child(5) {
			grid-row: 5;
			grid-column: 1;
		}
		.boxes-services__list > *:nth-child(6) {
			grid-row: 5;
			grid-column: 3;
		}
		.boxes-services__list > *:nth-child(7) {
			grid-row: 7;
			grid-column: 1;
		}
		.boxes-services__list > *:nth-child(8) {
			grid-row: 7;
			grid-column: 3;
		}
	}

	@media screen and (min-width: 64rem) {
		.boxes-services__list {
			display: grid;
			grid-template-columns: repeat(5, 17%);
			justify-content: center;
			grid-column-gap: 2rem;
		}
		.boxes-services__list > *:nth-child(1) {
			grid-row: 1;
			grid-column: 1;
		}
		.boxes-services__list > *:nth-child(2) {
			grid-row: 1;
			grid-column: 2;
		}
		.boxes-services__list > *:nth-child(3) {
			grid-row: 1;
			grid-column: 3;
		}
		.boxes-services__list > *:nth-child(4) {
			grid-row: 1;
			grid-column: 4;
		}
		.boxes-services__list > *:nth-child(5) {
			grid-row: 1;
			grid-column: 5;
		}
	}

	.boxes-services__item:not(.boxes-services__item[class*='3']) {
		opacity: 0;
		max-width: 23.125rem;
		margin-right: auto;
		margin-left: auto;
	}

	@media screen and (min-width: 47.82rem) {
		.boxes-services__item:nth-of-type(1) {
			grid-row: 1/3;
			align-self: start;
		}
		.boxes-services__item:nth-of-type(2) {
			grid-row: 2/3;
			grid-column: 2/3;
			align-self: start;
		}
		.boxes-services__item:nth-of-type(3) {
			grid-column: 1/2;
			align-self: start;
		}
		.boxes-services__item:nth-of-type(4) {
			grid-row: 4/5;
			grid-column: 2/3;
			align-self: start;
		}
		.boxes-services__item:nth-of-type(5) {
			grid-row: 5/-1;
			align-self: start;
		}
	}

	@media screen and (min-width: 64rem) {
		.boxes-services__item:nth-of-type(1) {
			grid-row: 1/1;
			grid-column: 1/2;
			align-self: start;
		}
		.boxes-services__item:nth-of-type(2) {
			grid-row: 1/1;
			grid-column: 2/3;
			align-self: start;
			animation-delay: 0.4s;
		}
		.boxes-services__item:nth-of-type(3) {
			grid-row: 1/1;
			grid-column: 3/4;
			align-self: start;
			animation-delay: 0.6s;
		}
		.boxes-services__item:nth-of-type(4) {
			grid-row: 1/1;
			grid-column: 4/5;
			align-self: start;
			animation-delay: 0.8s;
		}
		.boxes-services__item:nth-of-type(5) {
			grid-row: 1/1;
			grid-column: 5/6;
			align-self: start;
			animation-delay: 1s;
		}
	}

	.h-services__text {
		font-size: 0.8125em;
		font-weight: 900;
		text-transform: uppercase;
		text-align: center;
		letter-spacing: 1px;
		fill: #222222;
		color: #222222;
		background-color: #ffffff;
		border-style: solid;
		border-width: 5px 5px 2px 5px;
		border-color: #ffffff;
		border-radius: 0px 0px 0px 0px;
		box-shadow: 0px 15px 60px 0px rgba(0, 0, 0, 0.1);
		padding: 1em;
		display: grid;
		place-items: center;
		width: 90%;
		position: relative;
		top: -30px;
		margin: 0 auto;
	}

	.boxes-services__item {
		width: 100%;
		height: 100%;
		max-width: 23.125rem;
		margin-left: auto;
		margin-right: auto;
		box-sizing: border-box;
	}

	.h-services__img {
		width: 100%;
		height: auto;
		object-fit: cover;
		transition-duration: 0.3s;
		transition-property: transform;
		transition-timing-function: ease-out;
	}

	.h-services__img:hover {
		transform: translateY(-8px);
	}

	@keyframes slideInRight {
		0% {
			opacity: 0;
			transform: translateX(1000px);
		}
		100% {
			opacity: 1;
			transform: translateX(0);
		}
	}

	.slide-in-right {
		animation: slideInRight 0.8s ease-out forwards;
	}
</style>
